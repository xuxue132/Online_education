{"ast":null,"code":"import HeadTitle from \"@/components/MainBody/HeadTitle\";\nexport default {\n  name: \"PrizeText\",\n  components: {\n    HeadTitle\n  },\n  data() {\n    return {\n      Good: {},\n      dialogFormVisible: false,\n      Order: {\n        userName: '',\n        phone: '',\n        address: '',\n        remark: ''\n      },\n      people: {},\n      formLabelWidth: '120px',\n      rules: {\n        userName: [{\n          required: true,\n          message: '联系人不能为空'\n        }],\n        address: [{\n          required: true,\n          message: '联系地址不能为空'\n        }],\n        phone: [{\n          required: true,\n          message: '手机不能为空'\n        }, {\n          validator: (rule, value, callback) => {\n            const reg = /^1[(34578)][0-9]\\d{8}$/;\n            if (reg.test(value)) {\n              callback();\n            } else {\n              return callback(new Error(\"手机号码格式错误\"));\n            }\n          }\n        }]\n      }\n    };\n  },\n  created() {\n    this.GetGood();\n    this.GetUser();\n  },\n  methods: {\n    GetUser() {\n      this.$axios.post('public/MyInformation', {\n        token: this.$store.state.Authorization\n      }, {\n        headers: {\n          'Authorization': this.$store.state.Authorization\n        }\n      }).then(resp => {\n        if (resp.status === 200) {\n          this.people = resp.data.data;\n        }\n      }).catch(resp => {});\n    },\n    closed() {\n      this.$refs[\"Order\"].resetFields();\n    },\n    offIt() {\n      this.$refs['Order'].resetFields();\n      this.dialogFormVisible = false;\n    },\n    //格式化时间\n    formatDate(date) {\n      if (typeof date === 'string') {\n        return date;\n      }\n      let year = date.getFullYear();\n      let month = date.getMonth() + 1;\n      let day = date.getDate();\n      if (month < 10) {\n        month = \"0\" + month;\n      }\n      if (day < 10) {\n        day = \"0\" + day;\n      }\n      return year + \"-\" + month + \"-\" + day;\n    },\n    GetGood() {\n      this.$axios.post('public/AnGoods', {\n        id: this.$route.query.id\n      }, {\n        headers: {\n          'Authorization': this.$store.state.Authorization\n        }\n      }).then(resp => {\n        if (resp.status === 200) {\n          this.Good = resp.data.data;\n        }\n      }).catch(resp => {});\n    },\n    submitForm() {\n      this.$refs['Order'].validate(valid => {\n        if (valid) {\n          this.dialogFormVisible = false;\n          if (this.people.integral >= this.Good.points) {\n            this.$axios.post('public/GoodsAdd', {\n              userName: this.Order.userName,\n              commodityId: this.Good.id,\n              phone: this.Order.phone,\n              address: this.Order.address,\n              remark: this.Order.remark,\n              dates: this.formatDate(new Date()),\n              points: this.Good.points,\n              token: this.$store.state.Authorization\n            }, {\n              headers: {\n                'Authorization': this.$store.state.Authorization\n              }\n            }).then(resp => {\n              if (resp.status === 200) {\n                this.$message({\n                  message: \"兑换成功\",\n                  type: 'success'\n                });\n              }\n            }).catch(resp => {});\n          } else {\n            this.$message({\n              message: \"积分不足\",\n              type: 'success'\n            });\n          }\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["HeadTitle","name","components","data","Good","dialogFormVisible","Order","userName","phone","address","remark","people","formLabelWidth","rules","required","message","validator","rule","value","callback","reg","test","Error","created","GetGood","GetUser","methods","$axios","post","token","$store","state","Authorization","headers","then","resp","status","catch","closed","$refs","resetFields","offIt","formatDate","date","year","getFullYear","month","getMonth","day","getDate","id","$route","query","submitForm","validate","valid","integral","points","commodityId","dates","Date","$message","type"],"sources":["src/components/MainBody/Examination/PrizeText.vue"],"sourcesContent":["<template>\n    <div class=\"main_body\">\n        <HeadTitle></HeadTitle>\n        <div class=\"head_picture\"></div>\n        <div class=\"content row\">\n            <div class=\"sub_left\">\n                <h2 class=\"title_left flag1\">有奖竞答</h2>\n                <ul class=\"flag2 sub_menu\">\n                    <li>\n                        <a  title=\"知识竞答\" href=\"/ExaminationPage\" >知识竞答</a>\n                    </li>\n                    \n                    <li>\n                        <a  title=\"奖品兑换\" href=\"/PrizePage\" class=\"chs\">奖品兑换</a>\n                    </li>\n                \n                </ul>\n            </div>\n            <div class=\"sub_right\">\n                <div class=\"all\">\n                    <div class=\"changeTitle\">\n                        <span>商品信息</span>\n                    </div>\n                    \n                    <div class=\"aleft\">\n                        <div class=\"good_right\">\n                            <img :src=\"Good.picture\">\n                        </div>\n                        <div class=\"good_left\">\n                            <h1>{{Good.tradeName}}</h1>\n                            <p class=\"next\"><span>所需积分：</span><i>{{Good.points}}</i></p>\n                            <p><span>商品介绍：</span><span  class=\"ql-editor\" v-html=\"Good.introduce\"></span></p>\n    \n                            <el-button type=\"primary\" round @click=\"dialogFormVisible = true\" class=\"change\">立即兑换</el-button>\n                        </div>\n    \n                        <el-dialog title=\"奖品兑换\" :visible.sync=\"dialogFormVisible\" @close=\"closed\" :append-to-body=\"true\">\n                            <el-form :model=\"Order\" :rules=\"rules\" ref=\"Order\">\n                                <el-form-item label=\"联系姓名\" :label-width=\"formLabelWidth\" prop=\"userName\">\n                                    <el-input v-model=\"Order.userName\" clearable></el-input>\n                                </el-form-item>\n                                <el-form-item label=\"手机号码\" :label-width=\"formLabelWidth\" prop=\"phone\">\n                                    <el-input v-model=\"Order.phone\" clearable></el-input>\n                                </el-form-item>\n                                <el-form-item label=\"收件地址\" :label-width=\"formLabelWidth\" prop=\"address\">\n                                    <el-input v-model=\"Order.address\" clearable></el-input>\n                                </el-form-item>\n                                <el-form-item label=\"备注\" :label-width=\"formLabelWidth\" prop=\"remark\">\n                                    <el-input v-model=\"Order.remark\" clearable></el-input>\n                                </el-form-item>\n                            </el-form>\n                            <div slot=\"footer\" class=\"dialog-footer\">\n                                <el-button @click=\"offIt()\">取 消</el-button>\n                                <el-button type=\"primary\" @click=\"submitForm()\">确 定</el-button>\n                            </div>\n                        </el-dialog>\n                    </div>\n                </div>\n                <div class=\"bottoms\"></div>\n            \n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n    import HeadTitle from \"@/components/MainBody/HeadTitle\";\n    export default {\n        name: \"PrizeText\",\n        components: {HeadTitle},\n        data(){\n            return{\n                Good:{},\n                dialogFormVisible: false,\n                Order: {\n                    userName: '',\n                    phone: '',\n                    address: '',\n                    remark: '',\n                },\n                people:{},\n                formLabelWidth: '120px',\n                rules: {\n                    userName: [\n                        { required: true, message: '联系人不能为空'},\n                    ],\n                    address: [\n                        { required: true, message: '联系地址不能为空'},\n                    ],\n                    phone: [\n                        { required: true, message: '手机不能为空'},\n                        {\n                            validator: (rule, value, callback) => {\n                                const reg = /^1[(34578)][0-9]\\d{8}$/;\n                                if (reg.test(value)) {\n                                    callback();\n                                } else {\n                                    return callback(new Error(\"手机号码格式错误\"));\n                                }\n                            },\n                        }\n                    ],\n                }\n            }\n        },\n        created(){\n            this.GetGood();\n            this.GetUser();\n        },\n\n        methods: {\n            GetUser(){\n                this.$axios.post('public/MyInformation', {\n                    token: this.$store.state.Authorization,\n                }, {\n                    headers: {'Authorization': this.$store.state.Authorization}\n                }).then(resp => {\n                    if (resp.status === 200) {\n                        this.people = resp.data.data\n                    }\n                }).catch(resp => {\n                })\n            },\n            closed() {\n                this.$refs[\"Order\"].resetFields();\n            },\n            offIt(){\n                this.$refs['Order'].resetFields();\n                this.dialogFormVisible = false\n            },\n            //格式化时间\n            formatDate(date) {\n                if (typeof date === 'string'){\n                    return date\n                }\n\n                let year = date.getFullYear();\n                let month = date.getMonth()+1;\n                let day = date.getDate();\n                if (month < 10) {\n                    month = \"0\" + month;\n                }\n                if (day < 10) {\n                    day = \"0\" + day;\n                }\n                return year + \"-\" + month + \"-\" + day;\n            },\n            GetGood(){\n                this.$axios.post('public/AnGoods', {\n                    id: this.$route.query.id,\n                }, {\n                    headers: {'Authorization': this.$store.state.Authorization}\n                }).then(resp => {\n                    if (resp.status === 200) {\n                        this.Good = resp.data.data\n                    }\n                }).catch(resp => {\n                })\n            },\n            submitForm() {\n                this.$refs['Order'].validate((valid) => {\n                    if (valid) {\n                        this.dialogFormVisible = false\n                        if(this.people.integral >= this.Good.points){\n                            this.$axios.post('public/GoodsAdd', {\n                                userName: this.Order.userName,\n                                commodityId: this.Good.id,\n                                phone: this.Order.phone,\n                                address: this.Order.address,\n                                remark: this.Order.remark,\n                                dates: this.formatDate(new Date()),\n                                points: this.Good.points,\n                                token: this.$store.state.Authorization\n                            }, {\n                                headers: {'Authorization': this.$store.state.Authorization}\n                            }).then(resp => {\n                                if (resp.status === 200) {\n                                    this.$message({\n                                        message: \"兑换成功\",\n                                        type: 'success'\n                                    });\n                                }\n                            }).catch(resp => {\n                            })\n                        }else {\n                            this.$message({\n                                message: \"积分不足\",\n                                type: 'success'\n                            });\n                        }\n                        \n                        \n                    }\n                });\n            },\n\n        }\n    }\n</script>\n\n<style scoped>\n    @import '../../editor.css';\n    .main_body{\n        margin: 0;\n        padding: 0;\n        height: 100%;\n        width: 100%;\n    }\n    .head_picture{\n        height: 250px;\n        width: 100%;\n        background: url(\"http://rcqmzsxxw.com/rchema/xuexiwang/img/public/head_bg.png\");\n        /*background: url(\"https://api.ixiaowai.cn/gqapi/gqapi.php\");*/\n        background-size: cover;\n    }\n    .changeTitle {\n        width: 80%;\n        height: 36px;\n        line-height: 36px;\n        padding: 0 18px;\n        background: #f5f5f5;\n        color: #0d74b1;\n        font-size: 15px;\n\n    }\n    .changeTitle a {\n        color: #0d74b1;\n        font-size: 15px;\n        float: right;\n    }\n    .sub_left {\n        width: 230px;\n        float: left;\n        position: relative;\n        z-index: 3;\n        margin-top: -80px;\n        background: url(\"https://www.cqut.edu.cn/images/sub_left_bg.png\") top center no-repeat;\n        padding: 0 0 65px;\n        background-size: 100% auto;\n    }\n    .title_left {\n        line-height: 50px;\n        padding: 15px 10px 15px 40px;\n        color: #fff;\n        position: relative;\n        font-weight: normal;\n    }\n    .flag1 {\n        font-size: 30px;\n    }\n    .sub_menu {\n        margin: 0 0 0 20px;\n        background: #fdf4e1;\n        height: 199px;\n    }\n    .content {\n        position: relative;\n        z-index: 2;\n    }\n\n    .row {\n        width: 1500px;\n        margin: 0 auto;\n    }\n    .flag2 {\n        font-size: 18px;\n    }\n    .sub_menu > li > a {\n        display: block;\n        line-height: 36px;\n        color: #333;\n        padding: 17px 0 16px 30px;\n        position: relative;\n        border: 1px solid #ededed;\n        border-top: 0;\n    }\n    .sub_right {\n        margin: 0 0 0 230px;\n        background: #FFFFFF;\n    }\n\n    .page_title h3 {\n        padding: 25px 0;\n        color: #333;\n        text-align: center;\n    }\n\n    .chs{\n        background: #f0ad4e;\n        color: #fff;\n        border-color: #F0AD4E;\n    }\n\n    .bottoms{\n        height: 20px;\n    }\n\n    .card_img  img{\n        height: 80%;\n        width: 80%;\n        padding: 20px 20px;\n    }\n\n    .card_list_li span{\n        font-size: 18px;\n        font-weight: bold;\n        color: #363636;\n        margin-top: 12px;\n    }\n    .all{\n        margin: 30px 30px;\n    }\n    .good_right{\n        float: left;\n        width: 240px;\n        height: 240px;\n    }\n    .good_right img{\n        width: 100%;\n        height: 100%;\n    }\n    .good_left{\n        float: left;\n        margin-left: 30px;\n        width: 60%;\n        height: 60%;\n    }\n    .good_left h1{\n        margin-top: 10px;\n    }\n    .aleft{\n        margin-top: 20px;\n    }\n    .next{\n        margin-top: 30px;\n        font-size: 19px;\n    }\n    .good_left p {\n        font-size: 19px;\n        color: #565656;\n        line-height: 30px;\n    }\n    \n    .change{\n        margin-top: 10px;\n    }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}